---
const {
  titleEs,
  titleEn,
  descriptionEs,
  descriptionEn,
  tags = [],
  href = "#",
  year,
  role,
  preview,
  image,
  imageAlt,
} = Astro.props;

const isExternal = typeof href === "string" && href.startsWith("http");
---

<details class="group rounded-3xl border border-white/10 bg-white/4 transition-transform duration-300 ease-out hover:scale-[1.01] hover:border-white/20 hover:bg-white/6">
  <summary class="cursor-pointer list-none p-6 focus:outline-none [&::-webkit-details-marker]:hidden">
    <div class="flex items-center justify-between text-[11px] uppercase tracking-[0.25em] text-zinc-500">
      <span>{year}</span>
      {role && <span>{role}</span>}
    </div>
    <h3 class="mt-4 text-2xl font-display text-zinc-100">
      <span data-lang="es">{titleEs}</span>
      <span data-lang="en">{titleEn}</span>
    </h3>
    <p class="mt-3 text-sm text-zinc-300">
      <span data-lang="es">{descriptionEs}</span>
      <span data-lang="en">{descriptionEn}</span>
    </p>
    <div class="mt-6 flex flex-wrap gap-2 text-[10px] uppercase tracking-[0.2em] text-zinc-500">
      {tags.map((tag) => (
        <span class="rounded-full border border-white/10 px-2 py-1">{tag}</span>
      ))}
    </div>
    <div class="mt-6 flex items-center justify-between gap-3 text-xs text-zinc-400">
      <div class="rounded-full border border-white/10 bg-white/5 px-3 py-1 uppercase tracking-[0.2em] text-zinc-300">
        <span data-lang="es">Click para abrir</span>
        <span data-lang="en">Tap to expand</span>
      </div>
      <svg
        aria-hidden="true"
        viewBox="0 0 24 24"
        class="chevron h-4 w-4 text-zinc-300"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path d="M6 9l6 6 6-6" />
      </svg>
    </div>
  </summary>

  <div class="border-t border-white/10 px-6 pb-6 pt-6">
    <div class="space-y-4">
      {preview ? (
        <div class="overflow-hidden rounded-2xl border border-white/15 bg-black/30">
          <iframe
            src={preview}
            title={`${titleEs ?? titleEn ?? "Preview"}`}
            class="h-[360px] w-full"
            loading="lazy"
            referrerpolicy="no-referrer"
          ></iframe>
        </div>
      ) : image ? (
        <div class="overflow-hidden rounded-2xl border border-white/10">
          <img
            src={typeof image === "string" ? image : image.src}
            alt={imageAlt ?? ""}
            class="h-72 w-full object-cover"
            loading="lazy"
            decoding="async"
          />
        </div>
      ) : (
        <div class="rounded-2xl border border-dashed border-white/10 bg-white/2 p-6 text-sm text-zinc-400">
          <span data-lang="es">Vista previa no disponible.</span>
          <span data-lang="en">Preview not available.</span>
        </div>
      )}

      <div class="text-sm text-zinc-300">
        <span data-lang="es">{descriptionEs}</span>
        <span data-lang="en">{descriptionEn}</span>
      </div>
    </div>
  </div>
  </details>

<style>
  details .chevron {
    transition: transform 200ms ease;
  }
  details[open] .chevron {
    transform: rotate(180deg);
  }
</style>
